language: php
dist: trusty
php: 7.2

stages:
  - name: deploy-dev
    if: branch = development

cache:
  directories:
    - $HOME/.m2

jobs:
  include:
    #DEPLOY DEV STAGE
    - stage: deploy-dev
      name: "Deploy to heroku-dev"
      before_script:
        - openssl aes-256-cbc -K $encrypted_7a28ea5788df_key -iv $encrypted_7a28ea5788df_iv -in encrypt.tar.gz.enc -out encrypt.tar.gz -d
        - tar -xzvf encrypt.tar.gz
      script:
        - echo "skipping tests"
      deploy:
        provider: heroku
        skip_cleanup: true
        api_key:
    secure: "opa/fHvaMeURjK7sLtX+DKive1bNoJZopo8UMXvNtjvWz7EhucEOGTaj79zfk6B8AWJG6UvNSpRzoCt6DPnjMjkRVqnWxnX6Md3HGS2WVQ0jxf0s+L2QU32xFPD4E8hrCUW9UJgScdH5WTaA5r/0QoBvN4WfU7faYteHLRCvXy1Ky9+uTe7twEz5q6SMLySGvX3CWnjdzNglCGOyIK5acV8MT+5WYQtGMJq7wmSksBSLL+2Elom+rvvGE5zKxs6kCHvZuFYcb18zvGwF71Th1x3RbfqRPY8ly30wf/iObrbdHvaEHkvBHFdj6uNkAgyqDHhitm7AmzS/VxVEeJT3hcnvURXG8sWZxjtZ0CcKeotzDr6xmP+/xy3tygffLdGMxcJXDvgIww55bBJfrfTJfs52UdWK5kuCFZxTJw80L3nN1X1zdEPRRq23F7LucSpk178p7NOLFONBT43BomgQ4SFFdzBQqLKba1imFxcGYx00WY+C4OmPvZYZwO+5q38wgKnabjD8XSCoEzbSiI8P5x4l0HE+ACzPy+DIs0B4Pm8gacj3VKL/ffjiEsfzc8mQ/vbPxXqHsyOUcJXcim3ctE/Blqba/nPqCCYzbJNV1McQp5mzQm1Ughw/TGL0Qwnqzz8lqPVxsWi91eQE+4epyCFklwpVN0+ITvtaE9fglk4="
        app: udelvd-dev
        on:
          branch: development

#WHITE LIST
branches:
  only:
    - master
    - development